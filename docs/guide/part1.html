<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Part 1: Security Gatekeeper - Claude Code Guide</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
</head>
<body>
  <nav class="nav">
    <div class="nav-container">
      <a href="index.html" class="nav-logo">Claude Code Guide</a>
      <button class="nav-toggle" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <ul class="nav-menu">
        <li><a href="index.html">Home</a></li>
        <li><a href="part1.html">Security</a></li>
        <li><a href="part2.html">Scaffolding</a></li>
        <li><a href="part3.html">MCP</a></li>
        <li><a href="part4.html">Context7</a></li>
        <li><a href="part5.html">Commands</a></li>
        <li><a href="part6.html">Chats</a></li>
        <li><a href="part7.html">Hooks</a></li>
        <li><a href="reference.html">Reference</a></li>
      </ul>
    </div>
  </nav>

  <main class="container">
    <h1>Part 1: The Global CLAUDE.md as Security Gatekeeper</h1>

    <h2>The Memory Hierarchy</h2>
    <p>Claude Code loads CLAUDE.md files in a specific order:</p>

    <table>
      <thead>
        <tr>
          <th>Level</th>
          <th>Location</th>
          <th>Purpose</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>Enterprise</strong></td>
          <td><code>/etc/claude-code/CLAUDE.md</code></td>
          <td>Org-wide policies</td>
        </tr>
        <tr>
          <td><strong>Global User</strong></td>
          <td><code>~/.claude/CLAUDE.md</code></td>
          <td>Your standards for ALL projects</td>
        </tr>
        <tr>
          <td><strong>Project</strong></td>
          <td><code>./CLAUDE.md</code></td>
          <td>Team-shared project instructions</td>
        </tr>
        <tr>
          <td><strong>Project Local</strong></td>
          <td><code>./CLAUDE.local.md</code></td>
          <td>Personal project overrides</td>
        </tr>
      </tbody>
    </table>

    <p>Your global file applies to <strong>every single project</strong> you work on.</p>

    <h2>What Belongs in Global</h2>

    <h3>1. Identity & Authentication</h3>

    <pre><code class="language-markdown">## GitHub Account
**ALWAYS** use **YourUsername** for all projects:
- SSH: `git@github.com:YourUsername/&lt;repo&gt;.git`

## Docker Hub
Already authenticated. Username in `~/.env` as `DOCKER_HUB_USER`

## Deployment
Use Dokploy MCP for production. API URL in `~/.env`</code></pre>

    <p><strong>Why global?</strong> You use the same accounts everywhere. Define once, inherit everywhere.</p>

    <h3>2. The Gatekeeper Rules</h3>

    <pre><code class="language-markdown">## NEVER EVER DO

These rules are ABSOLUTE:

### NEVER Publish Sensitive Data
- NEVER publish passwords, API keys, tokens to git/npm/docker
- Before ANY commit: verify no secrets included

### NEVER Commit .env Files
- NEVER commit `.env` to git
- ALWAYS verify `.env` is in `.gitignore`

### NEVER Hardcode Credentials
- ALWAYS use environment variables</code></pre>

    <h2>Why This Matters: Claude Reads Your .env</h2>

    <p><a href="https://www.knostic.ai/blog/claude-loads-secrets-without-permission">Security researchers discovered</a> that Claude Code <strong>automatically reads <code>.env</code> files</strong> without explicit permission. <a href="https://www.backslash.security/blog/claude-code-security-best-practices">Backslash Security warns</a>:</p>

    <blockquote>
      <p>"If not restricted, Claude can read <code>.env</code>, AWS credentials, or <code>secrets.json</code> and leak them through 'helpful suggestions.'"</p>
    </blockquote>

    <p>Your global CLAUDE.md creates a <strong>behavioral gatekeeper</strong> — even if Claude has access, it won't output secrets.</p>

    <h2>Defense in Depth</h2>

    <table>
      <thead>
        <tr>
          <th>Layer</th>
          <th>What</th>
          <th>How</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1</td>
          <td>Behavioral rules</td>
          <td>Global CLAUDE.md "NEVER" rules</td>
        </tr>
        <tr>
          <td>2</td>
          <td>Access control</td>
          <td>Deny list in settings.json</td>
        </tr>
        <tr>
          <td>3</td>
          <td>Git safety</td>
          <td>.gitignore</td>
        </tr>
      </tbody>
    </table>

    <h2>Team Workflows: Evolving CLAUDE.md</h2>

    <p>Solo developers maintain their own CLAUDE.md. But what about teams? <a href="https://x.com/bcherny/status/2007179832300581177">Boris Cherny shares how Anthropic's Claude Code team does it</a>:</p>

    <blockquote>
      <p>"Our team shares a single CLAUDE.md for the Claude Code repo. We check it into git, and the whole team contributes multiple times a week. Anytime we see Claude do something incorrectly we add it to the CLAUDE.md, so Claude knows not to do it next time."</p>
    </blockquote>

    <p><strong>The key insight:</strong> CLAUDE.md isn't a static document you write once. It's a <strong>living file that evolves</strong> with your codebase.</p>

    <h3>The Pattern: Mistakes Become Documentation</h3>

    <pre><code>Claude makes mistake → You fix it → You add rule to CLAUDE.md → Claude never makes that mistake again</code></pre>

    <p>Example workflow:</p>
    <ol>
      <li>Claude uses deprecated API in PR</li>
      <li>Reviewer catches it</li>
      <li>Team adds to CLAUDE.md: <code>## API Guidelines\nNEVER use deprecated v1 endpoints. Always use v2.</code></li>
      <li>Future Claude sessions know to avoid v1</li>
    </ol>

    <h3>@.claude in PR Reviews</h3>

    <p>Using the <a href="https://docs.anthropic.com/en/docs/claude-code/github-actions">Claude Code GitHub Action</a>, you can tag <code>@.claude</code> directly in PR comments:</p>

    <pre><code>Reviewer comment on PR #142:
"@.claude add to CLAUDE.md: Always use our internal logger instead of console.log"</code></pre>

    <p>Claude updates CLAUDE.md as part of the PR itself. The lesson gets documented where it was learned.</p>

    <p><strong>To set this up:</strong></p>
    <pre><code class="language-bash">claude /install-github-action</code></pre>

    <h3>Compounding Engineering</h3>

    <p>This workflow embodies a concept called <a href="https://every.to/chain-of-thought/compound-engineering-how-every-codes-with-agents">Compounding Engineering</a>:</p>

    <blockquote>
      <p>"Each unit of engineering work should make subsequent units easier — not harder."</p>
    </blockquote>

    <p>The traditional approach: fix bug, move on, repeat same mistake later.</p>
    <p>The compounding approach: fix bug, document why, never repeat.</p>

    <pre><code>Plan → Work → Review → Compound → (better) Plan → ...</code></pre>

    <p><strong>The 80/20 inversion:</strong> Spend 80% on planning and review, 20% on execution. Each cycle feeds learnings back into the system. Your CLAUDE.md becomes institutional knowledge that compounds over time.</p>

    <p><strong>Resources:</strong></p>
    <ul>
      <li><a href="https://github.com/EveryInc/compound-engineering-plugin">Compound Engineering Plugin</a> — Claude Code plugin implementing this workflow</li>
      <li><a href="https://every.to/chain-of-thought/compound-engineering-how-every-codes-with-agents">How Every Codes with Agents</a> — Deep dive into the methodology</li>
    </ul>

    <div class="page-nav">
      <a href="index.html" class="prev">Home</a>
      <a href="part2.html" class="next">Part 2: Project Scaffolding</a>
    </div>
  </main>

  <footer class="footer">
    <p>Based on the guide by TheDecipherist • <a href="https://github.com/TheDecipherist/claude-code-mastery">GitHub Repository</a></p>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
